<!DOCTYPE html>
<html lang="pt-br">


<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ThinkSmart</title>
<link href="trabalho.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">



<body>


<div >
    <nav class="w3-sidebar w3-bar-block w3-black w3-animate-right w3-top w3-text-light-grey w3-large"
        style="z-index:3;width:250px;font-weight:bold;display:none;right:0;" id="mySidebar">
        <a href="javascript:void()" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-32" id="close">FECHAR</a>
        <p class="w3-bar-item w3-center w3-padding-16 logged-in">Olá <span class="logged-in" id="nomeUsuario-m"></span>, seja bem-vindo!</p>
        <a href="login.html" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16 logged-out">LOGIN/CRIAR CONTA</a>
        <a id="btn_logout-m" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16 logged-in">EFETUAR LOGOUT</a>
        <a href="#" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16">SOBRE NÓS</a>
        <a href="#" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16">CONTATO</a>
        <a href="create-post.html" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16">CRIAR POST</a>
        <h1  class="MenuMFiltro">FILTROS</h1>
        <button  onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16 btnFilter" id="TREND-m" value="Trend">TREND</button>
        <button  onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16 btnFilter" id="TECH-m" value="Tech">TECH</button>
        <button  onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16 btnFilter" id="UTILITY-m" value="Utility">UTILITY</button>
        <button  onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16 btnFilter" id="ECO-m" value="ECO">ECO</button>
        <button  onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16 btnFilter" id="OTHER-m" value="Other">OTHER</button>
        <button  onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16 btnFilterOut" id="filterOut-m" value="none" style="background-color: red !important;color:white !important">Limpar Filtros</button>
    </nav>
</div>

    
        
        
     

      
    <header class="header">

        <a href="trabalho.html"><img src="imgs/ThinkSmartL2.png" alt="logotrabalho"></a>
        <div class="input-container">
            <i class="fa fa-search"></i>
            
            <input class="input-field" type="text" placeholder="Search..." name="usrnm">
            
        </div>

        <nav>
            <ul class="top">
                <p class="logged-in">Olá <span class="logged-in" id="nomeUsuario"></span>, seja bem-vindo!</p>
                <a class="logged-in" id="btn_logout">
                    <li>Efetuar Logout</li>
                </a>
                <a class="logged-out" href="login.html">
                    <li>Login/Criar Conta</li>
                </a>
                <a href="#">
                    <li>Anunciar</li>
                </a>
                <a href="#">
                    <li>Quem somos</li>
                </a>

            </ul>
        </nav>


        <nav>
            <a href="javascript:void(0)" class="w3-right w3-button w3-white" id="MenuM" onclick="w3_open()">☰</a>
            
           
        </nav>
        
    </header>
    <div class="w3-overlay w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

    <div class="w3-main w3-content" style="max-width:400px;margin-top:0" id="MenuL"></div>
     


   
    <div class="tudo">
        <div class="container-fluid">
            <div class="row">
                <div class="col-2 menuBtn" id="CL">
                    <div class="btn-group-vertical" role="group" aria-label="Button group with nested dropdown"
                        id="Menu">

                        <button type="button" class="btn btn-secondary butaum btnFilter" id="TREND" value="Trend">Trend</button>
                        <button type="button" class="btn btn-secondary butaum btnFilter" id="TECH" value="Tech">Tech</button>
                        <button type="button" class="btn btn-secondary butaum btnFilter" id="UTILITY" value="Utility">Utility</button>
                        <button type="button" class="btn btn-secondary butaum btnFilter" id="ECO" value="ECO">Eco</button>
                        <button type="button" class="btn btn-secondary butaum btnFilter" id="OTHER" value="Other">Other</button>
                        <button type="button" style="background-color: red !important;color:white !important" class="btn btn-secondary butaum btnFilterOut" id="filterOut" value="none">Limpar Filtro</button>

                    </div>
                </div>
                <div class="col-8">
                    <div id="user-posts">

                    </div>
                    <div class="row justify-content-center">
                        <h1 style="background-color: #4c96d7">
                            DESTAQUES:
                        </h1>
                    </div>
                    <div class="row justify-content-center">
                        <div class="col-lg-10 col-sm-12">
                            <a href="trabalhoPG2.html"><img src="imgs/TrabalhoB3.jpg" alt="tt"></a>
                            <div class="desc">
                                <h1><a href="trabalhoPG2.html">Transformando lixo em qualidade</a><br>
                                    <id class="SubH1">By livingasean - October 4, 2019 - <a href="#">ECO</a></id>
                                </h1>

                                <p>Quem teria pensado nisso! Garrafas e frascos de plástico descartados podem se
                                    transformar em
                                    fofas caixas de guardanapo em forma de baleia. Sem mencionar bandejas de secagem de
                                    vidro que economizam água para a cozinha. Muitas idéias fantásticas para decoração
                                    de casa
                                    moderna e acessórios para garantir que tudo esteja organizado e no lugar!</p>
                            </div>

                        </div>
                    </div>
                    <div class="row justify-content-center">
                        <div class="col-lg-10 col-sm-12">
                            <a href="#"><img src="imgs/TrabalhoB2.jpg" alt="tt"></a>
                            <div class="desc">
                                <h1><a href="#">Quando se precisa de uma luz na comemoração</a><br>
                                    <id class="SubH1">By sonos - October 8, 2019 - <a href="#">UTILITY</a></id>
                                </h1>

                                <p>É melhor prevenir do que remediar, diz o ditado, e quando você menos esperar vai
                                    chegar a sua hora
                                    de brilhar! O Multi abridor sonos promete não te deixar na mão, armado com uma luz
                                    de led ele vai permitir
                                    total controle da situação quando necessário.
                                </p>
                            </div>

                        </div>
                    </div>
                    <div class="row justify-content-center">
                        <div class="col-lg-10 col-sm-12">
                            <a href="#"><img src="imgs/TrabalhoB1.jpg" alt="tt"></a>
                            <div class="desc">
                                <h1><a href="#">Praticidade um estilo de vida</a><br>
                                    <id class="SubH1">By JubileuCO. - October 2, 2019 - <a href="#">UTILITY</a></id>
                                </h1>

                                <p>É melhor prevenir do que remediar, diz o ditado, e quando você menos esperar vai
                                    chegar a sua hora
                                    de brilhar! O Multi abridor sonos promete não te deixar na mão, armado com uma luz
                                    de led ele vai permitir
                                    total controle da situação quando necessário.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-2 colBtn" id="CL">
                    <div class="btn-group-vertical" role="group" aria-label="Button group with nested dropdown"
                        id="PostBtnGrp">

                        <button type="button" class="btn btn-secondary" id="butaumPost">Criar Post</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br>
    <br>
    <br>
    <br>
    <footer class="pezin">

        <p>
            Nos siga em:<br>


        </p>
        Copyright 2020 - Todos os direitos reservados

        <a> ThinkSmart</a>

    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

</body>
<script src="login.js"></script>

<script>
    // Script to open and close sidebar
    function w3_open() {
      document.getElementById("mySidebar").style.display = "block";
      document.getElementById("myOverlay").style.display = "block";
    }
    
    function w3_close() {
      document.getElementById("mySidebar").style.display = "none";
      document.getElementById("myOverlay").style.display = "none";
    }
    
    // Modal Image Gallery
    function onClick(element) {
      document.getElementById("img01").src = element.src;
      document.getElementById("modal01").style.display = "block";
      var captionText = document.getElementById("caption");
      captionText.innerHTML = element.alt;
    }
    
    </script>

<script>
    if (!usuarioCorrente.login) {
        $(".logged-in").hide();
    }
    else {
        $(".logged-out").hide();
    }

    if(sessionStorage.getItem('filter')=='none')
    {
        document.getElementById("filterOut").style.display="none";
    }


    function filter(event) {
        event.preventDefault();
        let id = this.value;
        sessionStorage.setItem('filter',`${id}`);
        document.getElementById("filterOut").style.display="block";
        document.getElementById("filterOut-m").style.display="block";
        loadPosts();
    }

    function filterOut(event){
        event.preventDefault();
        let id = this.value;
        sessionStorage.setItem('filter',`${id}`);
        document.getElementById("filterOut").style.display="none";
        document.getElementById("filterOut-m").style.display="none";
        loadPosts();
    }

    function initPage() {

        // Associa a função de logout ao botão
        document.getElementById('btn_logout').addEventListener('click', logoutUser);
        document.getElementById('btn_logout-m').addEventListener('click', logoutUser);

        // Informa o nome do usuário logado
        document.getElementById('nomeUsuario').innerHTML = usuarioCorrente.nome;
        document.getElementById('nomeUsuario-m').innerHTML = usuarioCorrente.nome;

        sessionStorage.setItem('filter','none');
        document.getElementById("filterOut").style.display="none";
        document.getElementById("filterOut-m").style.display="none";

        document.getElementById('TREND').addEventListener('click', filter);
        document.getElementById('TECH').addEventListener('click', filter);
        document.getElementById('UTILITY').addEventListener('click', filter);
        document.getElementById('ECO').addEventListener('click', filter);
        document.getElementById('OTHER').addEventListener('click', filter);
        document.getElementById('TREND-m').addEventListener('click', filter);
        document.getElementById('TECH-m').addEventListener('click', filter);
        document.getElementById('UTILITY-m').addEventListener('click', filter);
        document.getElementById('ECO-m').addEventListener('click', filter);
        document.getElementById('OTHER-m').addEventListener('click', filter);
        document.getElementById('filterOut').addEventListener('click', filterOut);
        document.getElementById('filterOut-m').addEventListener('click', filterOut);
    }



    function loadPosts() {

        let db_posts = JSON.parse(localStorage.getItem('db_posts'));
        let db_notas = JSON.parse(localStorage.getItem('db_notas'));
        let postSpace = document.getElementById('user-posts');
        let hasNotaFinal,j;
        let notaTotal;
        let texto = '';
        let filter = sessionStorage.getItem('filter');
        if(db_posts){
            if(filter=='none'){
                for (i = db_posts.posts.length - 1; i >= 0; i--) {
                    hasNotaFinal=0;
                    if(db_notas!=null){
                        for(j=0;j<db_notas.notas.length;j++)
                        {
                            //console.log(`${j}-${hasNotaFinal}`);
                            //console.log(`--${db_posts.posts[i].id}--${db_notas.notas[j].id}`);
                            if(db_notas.notas[j].id==db_posts.posts[i].id)
                            {
                                notaTotal = db_notas.notas[j].notaTotal;
                                hasNotaFinal=1;
                            }
                            //console.log(`${j}-${hasNotaFinal}`);
                        }
                    }

                    if(hasNotaFinal==1){
                        if (db_posts.posts[i].text.length < 250) {
                            texto += `
                                <div id="row-post-${i}" class="row justify-content-center">
                                    <div class="col-lg-10 col-sm-12">
                                        <a id="${i + 100}" class="link-to-post" onclick="prepareLink(this.id)" href="javascript:;"><img src="imgs/placeholder.jpg" alt="tt"></a>
                                        <div class="desc">
                                            <h1><a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">${db_posts.posts[i].title}</a><br>
                                                <id class="SubH1">By <a href="#">${db_posts.posts[i].author}</a> - ${db_posts.posts[i].time} - <a href="#">${db_posts.posts[i].company}</a> - <a href="#">${db_posts.posts[i].tag}</a></id>
                                            </h1>
                                            <p class="new-text">${db_posts.posts[i].text}
                                            </p>
                                        </div>
                                        <div class="desc">
                                            <p>
                                                Nota: ${notaTotal}/10
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                `
                        }
                        else {
                            texto += `
                                <div id="row-post-${i}" class="row justify-content-center">
                                    <div class="col-lg-10 col-sm-12">
                                        <a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;"><img src="imgs/placeholder.jpg" alt="tt"></a>
                                        <div class="desc">
                                            <h1><a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">${db_posts.posts[i].title}</a><br>
                                                <id class="SubH1">By <a href="#">${db_posts.posts[i].author}</a> - ${db_posts.posts[i].time} - <a href="#">${db_posts.posts[i].company}</a> - <a href="#">${db_posts.posts[i].tag}</a></id>
                                            </h1>
                    
                                            <p class="new-text">${db_posts.posts[i].text.slice(0, 250)}...
                                            </p>
                                            <p>
                                            <a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">Leia mais...</a>
                                            </p>
                                            </div>
                                            <div class="desc">
                                            <p>
                                                Nota: ${notaTotal}/10
                                            </p>
                                        </div>
                                    </div>
                                    
                                </div>
                                `
                        }
                    }
                    else{
                        if (db_posts.posts[i].text.length < 250) {
                            texto += `
                                <div id="row-post-${i}" class="row justify-content-center">
                                    <div class="col-lg-10 col-sm-12">
                                        <a id="${i + 100}" class="link-to-post" onclick="prepareLink(this.id)" href="javascript:;"><img src="imgs/placeholder.jpg" alt="tt"></a>
                                        <div class="desc">
                                            <h1><a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">${db_posts.posts[i].title}</a><br>
                                                <id class="SubH1">By <a href="#">${db_posts.posts[i].author}</a> - ${db_posts.posts[i].time} - <a href="#">${db_posts.posts[i].company}</a> - <a href="#">${db_posts.posts[i].tag}</a></id>
                                            </h1>
                                            <p class="new-text">${db_posts.posts[i].text}
                                            </p>
                                            </div>
                                    </div>
                                </div>
                                `
                        }
                        else {
                            texto += `
                                <div id="row-post-${i}" class="row justify-content-center">
                                    <div class="col-lg-10 col-sm-12">
                                        <a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;"><img src="imgs/placeholder.jpg" alt="tt"></a>
                                        <div class="desc">
                                            <h1><a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">${db_posts.posts[i].title}</a><br>
                                                <id class="SubH1">By <a href="#">${db_posts.posts[i].author}</a> - ${db_posts.posts[i].time} - <a href="#">${db_posts.posts[i].company}</a> - <a href="#">${db_posts.posts[i].tag}</a></id>
                                            </h1>
                    
                                            <p class="new-text">${db_posts.posts[i].text.slice(0, 250)}...
                                            </p>
                                            <p>
                                            <a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">Leia mais...</a>
                                            </p>
                                            </div>
                                    </div>
                                </div>
                                `
                        }
                    }
                }

                postSpace.innerHTML = texto;
            }
            else{
                for (i = db_posts.posts.length - 1; i >= 0; i--) {
                    if(db_posts.posts[i].tag==filter){
                        hasNotaFinal=0;
                        if(db_notas!=null){
                            for(j=0;j<db_notas.notas.length;j++)
                            {
                                //console.log(`--${db_posts.posts[i].id},${db_notas.notas[j].id}`);
                                if(db_notas.notas[j].id==db_posts.posts[i].id)
                                {
                                    notaTotal = db_notas.notas[j].notaTotal;
                                    hasNotaFinal=1;
                                }
                            }
                        }

                        if(hasNotaFinal==1){
                            if (db_posts.posts[i].text.length < 250) {
                                texto += `
                                    <div id="row-post-${i}" class="row justify-content-center">
                                        <div class="col-lg-10 col-sm-12">
                                            <a id="${i + 100}" class="link-to-post" onclick="prepareLink(this.id)" href="javascript:;"><img src="imgs/placeholder.jpg" alt="tt"></a>
                                            <div class="desc">
                                                <h1><a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">${db_posts.posts[i].title}</a><br>
                                                    <id class="SubH1">By <a href="#">${db_posts.posts[i].author}</a> - ${db_posts.posts[i].time} - <a href="#">${db_posts.posts[i].company}</a> - <a href="#">${db_posts.posts[i].tag}</a></id>
                                                </h1>
                                                <p class="new-text">${db_posts.posts[i].text}
                                                </p>
                                            </div>
                                            <div class="desc">
                                                <p>
                                                    Nota: ${notaTotal}/10
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    `
                            }
                            else {
                                texto += `
                                    <div id="row-post-${i}" class="row justify-content-center">
                                        <div class="col-lg-10 col-sm-12">
                                            <a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;"><img src="imgs/placeholder.jpg" alt="tt"></a>
                                            <div class="desc">
                                                <h1><a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">${db_posts.posts[i].title}</a><br>
                                                    <id class="SubH1">By <a href="#">${db_posts.posts[i].author}</a> - ${db_posts.posts[i].time} - <a href="#">${db_posts.posts[i].company}</a> - <a href="#">${db_posts.posts[i].tag}</a></id>
                                                </h1>
                        
                                                <p class="new-text">${db_posts.posts[i].text.slice(0, 250)}...
                                                </p>
                                                <p>
                                                <a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">Leia mais...</a>
                                                </p>
                                                </div>
                                                <div class="desc">
                                                <p>
                                                    Nota: ${notaTotal}/10
                                                </p>
                                        </div>
                                        </div>
                                    </div>
                                    `
                            }
                        }
                        else{
                            if (db_posts.posts[i].text.length < 250) {
                                texto += `
                                    <div id="row-post-${i}" class="row justify-content-center">
                                        <div class="col-lg-10 col-sm-12">
                                            <a id="${i + 100}" class="link-to-post" onclick="prepareLink(this.id)" href="javascript:;"><img src="imgs/placeholder.jpg" alt="tt"></a>
                                            <div class="desc">
                                                <h1><a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">${db_posts.posts[i].title}</a><br>
                                                    <id class="SubH1">By <a href="#">${db_posts.posts[i].author}</a> - ${db_posts.posts[i].time} - <a href="#">${db_posts.posts[i].company}</a> - <a href="#">${db_posts.posts[i].tag}</a></id>
                                                </h1>
                                                <p class="new-text">${db_posts.posts[i].text}
                                                </p>
                                                </div>
                                        </div>
                                    </div>
                                    `
                            }
                            else {
                                texto += `
                                    <div id="row-post-${i}" class="row justify-content-center">
                                        <div class="col-lg-10 col-sm-12">
                                            <a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;"><img src="imgs/placeholder.jpg" alt="tt"></a>
                                            <div class="desc">
                                                <h1><a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">${db_posts.posts[i].title}</a><br>
                                                    <id class="SubH1">By <a href="#">${db_posts.posts[i].author}</a> - ${db_posts.posts[i].time} - <a href="#">${db_posts.posts[i].company}</a> - <a href="#">${db_posts.posts[i].tag}</a></id>
                                                </h1>
                        
                                                <p class="new-text">${db_posts.posts[i].text.slice(0, 250)}...
                                                </p>
                                                <p>
                                                <a class="link-to-post" id="${i + 100}" onclick="prepareLink(this.id)" href="javascript:;">Leia mais...</a>
                                                </p>
                                                </div>
                                        </div>
                                    </div>
                                    `
                            }
                        }
                    }

                    postSpace.innerHTML = texto;
                }
            }
        }
        else{
            texto = `<h1 style="background-color: #4c96d7;">Não há posts novos!</h1>`;
            postSpace.innerHTML = texto;
        }
        if(texto=='')
        {
            texto = `<h1 style="background-color: #4c96d7;">Não há posts novos!</h1>`;
            postSpace.innerHTML = texto;
        }
    }

    db_posts = JSON.parse(localStorage.getItem('db_posts'));


    if (db_posts) {
        loadPosts();
    }

    else{
        let postSpace = document.getElementById('user-posts');
        let texto = `<h1 style="background-color: #4c96d7;">Não há posts novos!</h1>`;
        postSpace.innerHTML = texto;
    }

    function prepareLink(value) {
        console.log(value);
        let postTo = db_posts.posts[value - 100];
        localStorage.setItem('postTo', JSON.stringify(postTo));
        window.location.href = 'newpage.html';
    }

    window.addEventListener('load', initPage);
    $("#butaumPost").click(function () {
        window.location.href = 'create-post.html';
    });




</script>

</html>